<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåø Green Hill Canarias - AI Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-green-800 mb-4">
                üåø Green Hill Canarias ‚Äî AI Portal
            </h1>
            <div class="flex justify-center gap-4 mb-4">
                <select id="language" class="p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" onchange="switchLanguage()">
                    <option value="en">üá¨üáß English</option>
                    <option value="is">üáÆüá∏ √çslenska</option>
                    <option value="fr">üá´üá∑ Fran√ßais</option>
                    <option value="es">üá™üá∏ Espa√±ol</option>
                </select>
            </div>
            <p class="text-lg text-gray-600" id="subtitle">Digital Twin powered by advanced AI</p>
        </header>

        <!-- Audience Selector -->
        <div class="max-w-2xl mx-auto mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2" id="audienceLabel">Select Audience:</label>
            <select id="audience" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                <option value="public">üåç Public - General Information</option>
                <option value="investor">üí∞ Investor - Financial Metrics</option>
                <option value="boardroom">üëî Boardroom - Executive Decisions</option>
            </select>
        </div>

        <!-- Main Chat Interface -->
        <div class="max-w-6xl mx-auto bg-white rounded-xl shadow-lg p-6 mb-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Chat Panel -->
                <div class="lg:col-span-2">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4" id="chatTitle">üí¨ Chat with Digital Twin</h2>
                    
                    <div id="messages" class="bg-gray-50 rounded-lg p-4 mb-4 min-h-[300px] max-h-[400px] overflow-y-auto">
                        <div class="text-gray-500 text-center" id="welcomeMsg">Ask your first question to begin...</div>
                    </div>
                    
                    <!-- Input Methods -->
                    <div class="space-y-3">
                        <!-- Text Input -->
                        <div class="flex gap-2">
                            <input 
                                type="text" 
                                id="messageInput" 
                                placeholder="Type your question here..." 
                                class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                onkeypress="handleKeyPress(event)"
                            >
                            <button onclick="sendMessage()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors" id="sendButton">
                                <i class="fas fa-paper-plane"></i> <span id="sendText">Send</span>
                            </button>
                        </div>
                        
                        <!-- Voice Input -->
                        <div class="flex gap-2">
                            <button onclick="toggleVoiceRecording()" class="flex-1 bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 transition-colors" id="voiceButton">
                                <i class="fas fa-microphone"></i> <span id="voiceText">Voice Input</span>
                            </button>
                            <button onclick="toggleImageCapture()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ingestion Panel -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4" id="ingestTitle">üìÅ Content Ingestion</h3>
                    
                    <!-- File Upload -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2" id="fileLabel">Upload Files:</label>
                        <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.txt,.md,.json,.csv" class="hidden" onchange="handleFileUpload(event)">
                        <button onclick="document.getElementById('fileInput').click()" class="w-full bg-gray-600 text-white p-3 rounded-lg hover:bg-gray-700 transition-colors">
                            <i class="fas fa-upload"></i> <span id="uploadText">Choose Files</span>
                        </button>
                    </div>

                    <!-- URL Input -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2" id="urlLabel">Ingest URL:</label>
                        <div class="flex gap-2">
                            <input type="url" id="urlInput" placeholder="https://..." class="flex-1 p-2 border border-gray-300 rounded-lg">
                            <button onclick="ingestUrl()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">
                                <i class="fas fa-link"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Image/Video Upload -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2" id="mediaLabel">Media Files:</label>
                        <input type="file" id="mediaInput" multiple accept="image/*,video/*" class="hidden" onchange="handleMediaUpload(event)">
                        <button onclick="document.getElementById('mediaInput').click()" class="w-full bg-orange-600 text-white p-3 rounded-lg hover:bg-orange-700 transition-colors">
                            <i class="fas fa-image"></i> <span id="mediaText">Images/Videos</span>
                        </button>
                    </div>

                    <!-- Webcam Capture -->
                    <button onclick="toggleWebcam()" class="w-full bg-red-600 text-white p-3 rounded-lg hover:bg-red-700 transition-colors" id="webcamButton">
                        <i class="fas fa-video"></i> <span id="webcamText">Live Capture</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- System Status -->
        <div class="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4" id="statusTitle">üìä System Status</h2>
            <div class="space-y-2" id="statusList">
                <div class="flex items-center justify-between">
                    <span class="text-gray-600">Digital Twin:</span>
                    <span class="text-green-600 font-medium" id="dtStatus">‚úÖ Active</span>
                </div>
                <div class="flex items-center justify-between">
                    <span class="text-gray-600">Voice Recognition:</span>
                    <span class="text-green-600 font-medium" id="voiceStatus">‚úÖ Ready</span>
                </div>
                <div class="flex items-center justify-between">
                    <span class="text-gray-600">Image Processing:</span>
                    <span class="text-green-600 font-medium" id="imageStatus">‚úÖ Ready</span>
                </div>
            </div>
        </div>

        <!-- Hidden Elements -->
        <video id="webcamVideo" class="hidden" width="320" height="240" autoplay></video>
        <canvas id="webcamCanvas" class="hidden"></canvas>

        <!-- Footer -->
        <footer class="text-center mt-12 text-gray-500">
            <p id="footerText">Developed for Green Hill Canarias | Multi-modal AI Interface</p>
            <p class="mt-2">
                <a href="https://github.com/ZAKIBAYDOUN/GHC-DT" target="_blank" class="text-green-600 hover:underline">
                    <i class="fab fa-github"></i> View on GitHub
                </a>
            </p>
        </footer>
    </div>

    <script>
        // Language definitions
        const languages = {
            en: {
                subtitle: "Digital Twin powered by advanced AI",
                audienceLabel: "Select Audience:",
                chatTitle: "üí¨ Chat with Digital Twin",
                welcomeMsg: "Ask your first question to begin...",
                sendText: "Send",
                voiceText: "Voice Input",
                ingestTitle: "üìÅ Content Ingestion",
                fileLabel: "Upload Files:",
                uploadText: "Choose Files",
                urlLabel: "Ingest URL:",
                mediaLabel: "Media Files:",
                mediaText: "Images/Videos",
                webcamText: "Live Capture",
                statusTitle: "üìä System Status",
                dtStatus: "‚úÖ Active",
                voiceStatus: "‚úÖ Ready",
                imageStatus: "‚úÖ Ready",
                footerText: "Developed for Green Hill Canarias | Multi-modal AI Interface",
                audiences: {
                    public: "üåç Public - General Information",
                    investor: "üí∞ Investor - Financial Metrics", 
                    boardroom: "üëî Boardroom - Executive Decisions"
                }
            },
            is: {
                subtitle: "Stafr√¶nn tv√≠bur√∞ur kn√∫inn af h√°√ær√≥a√∞ri gervigreind",
                audienceLabel: "Veldu markh√≥p:",
                chatTitle: "üí¨ Spjall vi√∞ stafr√¶nan tv√≠bura",
                welcomeMsg: "Spur√∞u fyrstu spurninguna √æ√≠na til a√∞ byrja...",
                sendText: "Senda",
                voiceText: "Raddinntak",
                ingestTitle: "üìÅ Efnisupptaka",
                fileLabel: "Hla√∞a upp skr√°m:",
                uploadText: "Veldu skr√°r",
                urlLabel: "Upptaka vefsl√≥√∞:",
                mediaLabel: "Mi√∞laskr√°r:",
                mediaText: "Myndir/Myndb√∂nd",
                webcamText: "Bein upptaka",
                statusTitle: "üìä Sta√∞a kerfis",
                dtStatus: "‚úÖ Virkt",
                voiceStatus: "‚úÖ Tilb√∫i√∞",
                imageStatus: "‚úÖ Tilb√∫i√∞",
                footerText: "√ûr√≥a√∞ fyrir Green Hill Canarias | Fj√∂lmi√∞la AI vi√∞m√≥t",
                audiences: {
                    public: "üåç Almenningur - Almennar uppl√Ωsingar",
                    investor: "üí∞ Fj√°rfestar - Fj√°rm√°lam√¶lingar",
                    boardroom: "üëî Stj√≥rnarherbergi - Framkv√¶mda√°kvar√∞anir"
                }
            },
            fr: {
                subtitle: "Jumeau num√©rique aliment√© par l'IA avanc√©e",
                audienceLabel: "S√©lectionner l'audience:",
                chatTitle: "üí¨ Chat avec le Jumeau Num√©rique",
                welcomeMsg: "Posez votre premi√®re question pour commencer...",
                sendText: "Envoyer",
                voiceText: "Entr√©e vocale",
                ingestTitle: "üìÅ Ingestion de contenu",
                fileLabel: "T√©l√©charger des fichiers:",
                uploadText: "Choisir fichiers",
                urlLabel: "Ing√©rer l'URL:",
                mediaLabel: "Fichiers m√©dia:",
                mediaText: "Images/Vid√©os",
                webcamText: "Capture en direct",
                statusTitle: "üìä √âtat du syst√®me",
                dtStatus: "‚úÖ Actif",
                voiceStatus: "‚úÖ Pr√™t",
                imageStatus: "‚úÖ Pr√™t",
                footerText: "D√©velopp√© pour Green Hill Canarias | Interface IA multimodale",
                audiences: {
                    public: "üåç Public - Informations g√©n√©rales",
                    investor: "üí∞ Investisseur - M√©triques financi√®res",
                    boardroom: "üëî Salle de conseil - D√©cisions ex√©cutives"
                }
            },
            es: {
                subtitle: "Gemelo Digital impulsado por IA avanzada",
                audienceLabel: "Seleccionar Audiencia:",
                chatTitle: "üí¨ Chat con el Gemelo Digital",
                welcomeMsg: "Haz tu primera pregunta para comenzar...",
                sendText: "Enviar",
                voiceText: "Entrada de voz",
                ingestTitle: "üìÅ Ingesta de contenido",
                fileLabel: "Subir archivos:",
                uploadText: "Elegir archivos",
                urlLabel: "Ingesta URL:",
                mediaLabel: "Archivos multimedia:",
                mediaText: "Im√°genes/Videos",
                webcamText: "Captura en vivo",
                statusTitle: "üìä Estado del sistema",
                dtStatus: "‚úÖ Activo",
                voiceStatus: "‚úÖ Listo",
                imageStatus: "‚úÖ Listo",
                footerText: "Desarrollado para Green Hill Canarias | Interfaz IA multimodal",
                audiences: {
                    public: "üåç P√∫blico - Informaci√≥n general",
                    investor: "üí∞ Inversor - M√©tricas financieras",
                    boardroom: "üëî Sala de juntas - Decisiones ejecutivas"
                }
            }
        };

        // Global variables
        let messages = [];
        let currentLang = 'en';
        let isRecording = false;
        let mediaRecorder = null;
        let webcamStream = null;
        let recognition = null;

        // Language switching
        function switchLanguage() {
            currentLang = document.getElementById('language').value;
            const lang = languages[currentLang];
            
            document.getElementById('subtitle').textContent = lang.subtitle;
            document.getElementById('audienceLabel').textContent = lang.audienceLabel;
            document.getElementById('chatTitle').textContent = lang.chatTitle;
            document.getElementById('sendText').textContent = lang.sendText;
            document.getElementById('voiceText').textContent = lang.voiceText;
            document.getElementById('ingestTitle').textContent = lang.ingestTitle;
            document.getElementById('fileLabel').textContent = lang.fileLabel;
            document.getElementById('uploadText').textContent = lang.uploadText;
            document.getElementById('urlLabel').textContent = lang.urlLabel;
            document.getElementById('mediaLabel').textContent = lang.mediaLabel;
            document.getElementById('mediaText').textContent = lang.mediaText;
            document.getElementById('webcamText').textContent = lang.webcamText;
            document.getElementById('statusTitle').textContent = lang.statusTitle;
            document.getElementById('dtStatus').textContent = lang.dtStatus;
            document.getElementById('voiceStatus').textContent = lang.voiceStatus;
            document.getElementById('imageStatus').textContent = lang.imageStatus;
            document.getElementById('footerText').textContent = lang.footerText;
            
            // Update audience options
            const audienceSelect = document.getElementById('audience');
            audienceSelect.innerHTML = `
                <option value="public">${lang.audiences.public}</option>
                <option value="investor">${lang.audiences.investor}</option>
                <option value="boardroom">${lang.audiences.boardroom}</option>
            `;
            
            // Update welcome message if no messages yet
            if (messages.length === 0) {
                document.getElementById('welcomeMsg').textContent = lang.welcomeMsg;
            }
        }

        // Voice Recognition Setup
        function initVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = currentLang === 'is' ? 'is-IS' : 
                                 currentLang === 'fr' ? 'fr-FR' :
                                 currentLang === 'es' ? 'es-ES' : 'en-US';
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('messageInput').value = transcript;
                };
                
                recognition.onerror = function(event) {
                    addMessage('system', `Voice recognition error: ${event.error}`);
                };
            }
        }

        // Voice Recording
        function toggleVoiceRecording() {
            if (!isRecording) {
                if (recognition) {
                    recognition.lang = currentLang === 'is' ? 'is-IS' : 
                                     currentLang === 'fr' ? 'fr-FR' :
                                     currentLang === 'es' ? 'es-ES' : 'en-US';
                    recognition.start();
                    isRecording = true;
                    document.getElementById('voiceButton').innerHTML = '<i class="fas fa-stop"></i> Stop Recording';
                    document.getElementById('voiceButton').classList.add('bg-red-600');
                } else {
                    addMessage('system', 'Voice recognition not supported in this browser');
                }
            } else {
                if (recognition) recognition.stop();
                isRecording = false;
                document.getElementById('voiceButton').innerHTML = `<i class="fas fa-microphone"></i> ${languages[currentLang].voiceText}`;
                document.getElementById('voiceButton').classList.remove('bg-red-600');
            }
        }

        // Image Capture
        function toggleImageCapture() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.capture = 'camera';
            input.onchange = function(e) {
                handleImageUpload(e.target.files);
            };
            input.click();
        }

        // Webcam functionality
        function toggleWebcam() {
            const video = document.getElementById('webcamVideo');
            if (!webcamStream) {
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then(stream => {
                        webcamStream = stream;
                        video.srcObject = stream;
                        video.classList.remove('hidden');
                        document.getElementById('webcamButton').innerHTML = '<i class="fas fa-stop"></i> Stop Capture';
                    })
                    .catch(err => {
                        addMessage('system', `Webcam error: ${err.message}`);
                    });
            } else {
                webcamStream.getTracks().forEach(track => track.stop());
                webcamStream = null;
                video.classList.add('hidden');
                document.getElementById('webcamButton').innerHTML = `<i class="fas fa-video"></i> ${languages[currentLang].webcamText}`;
            }
        }

        // File handling
        function handleFileUpload(event) {
            const files = event.target.files;
            for (let file of files) {
                addMessage('system', `File uploaded: ${file.name} (${(file.size/1024).toFixed(1)} KB)`);
                // Here you would typically send the file to your backend
            }
        }

        function handleMediaUpload(event) {
            const files = event.target.files;
            for (let file of files) {
                addMessage('system', `Media uploaded: ${file.name}`);
                // Process media files here
            }
        }

        function handleImageUpload(files) {
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    addMessage('user', `üì∑ Image uploaded: ${file.name}`);
                    // Process image here
                };
                reader.readAsDataURL(file);
            }
        }

        // URL ingestion
        function ingestUrl() {
            const url = document.getElementById('urlInput').value;
            if (url) {
                addMessage('system', `URL queued for ingestion: ${url}`);
                document.getElementById('urlInput').value = '';
            }
        }

        // Send message function (DEMO - replace with real backend)
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const question = input.value.trim();
            const audience = document.getElementById('audience').value;
            
            if (!question) return;

            addMessage('user', question);
            input.value = '';

            // DEMO responses - replace with actual DigitalRoots API call
            setTimeout(() => {
                const responses = {
                    en: "üåø **GHC Digital Twin Response**\\n\\nThis is a demo response. To connect to your actual DigitalRoots system:\\n\\n1. Deploy your backend API\\n2. Update the backend URL\\n3. Configure your assistant IDs\\n\\nFor now, this interface demonstrates:\\n‚úÖ Multi-language support\\n‚úÖ Voice input\\n‚úÖ Image capture\\n‚úÖ File ingestion\\n‚úÖ Professional UI",
                    is: "üåø **GHC Stafr√¶nn Tv√≠buri Svar**\\n\\n√ûetta er prufusvar. Til a√∞ tengjast raunverulegu DigitalRoots kerfinu √æ√≠nu:\\n\\n1. Settu upp bakenda API\\n2. Uppf√¶r√∞u bakenda vefsl√≥√∞ina\\n3. Stilltu au√∞kenni a√∞sto√∞armanna\\n\\n√ûar til s√Ωnir √æessi vi√∞m√≥t:\\n‚úÖ Fj√∂ltungum√°lastu√∞ning\\n‚úÖ Raddinntak\\n‚úÖ Myndataka\\n‚úÖ Skr√°ainntak\\n‚úÖ Fagleg notendavi√∞m√≥t",
                    fr: "üåø **R√©ponse Jumeau Num√©rique GHC**\\n\\nCeci est une r√©ponse de d√©monstration. Pour vous connecter √† votre v√©ritable syst√®me DigitalRoots:\\n\\n1. D√©ployez votre API backend\\n2. Mettez √† jour l'URL du backend\\n3. Configurez vos ID d'assistant\\n\\nPour l'instant, cette interface d√©montre:\\n‚úÖ Support multilingue\\n‚úÖ Entr√©e vocale\\n‚úÖ Capture d'image\\n‚úÖ Ingestion de fichiers\\n‚úÖ Interface professionnelle",
                    es: "üåø **Respuesta Gemelo Digital GHC**\\n\\nEsta es una respuesta de demostraci√≥n. Para conectar con tu sistema DigitalRoots real:\\n\\n1. Despliega tu API backend\\n2. Actualiza la URL del backend\\n3. Configura tus IDs de asistente\\n\\nPor ahora, esta interfaz demuestra:\\n‚úÖ Soporte multiidioma\\n‚úÖ Entrada de voz\\n‚úÖ Captura de imagen\\n‚úÖ Ingesta de archivos\\n‚úÖ Interfaz profesional"
                };
                addMessage('assistant', responses[currentLang]);
            }, 1000);
        }

        // Add message to chat
        function addMessage(sender, content) {
            const messagesDiv = document.getElementById('messages');
            
            if (messages.length === 0) {
                messagesDiv.innerHTML = '';
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = `mb-4 ${sender === 'user' ? 'text-right' : 'text-left'}`;
            
            let bgColor, textColor, icon;
            if (sender === 'user') {
                bgColor = 'bg-green-600';
                textColor = 'text-white';
                icon = 'üë§';
            } else if (sender === 'assistant') {
                bgColor = 'bg-gray-600';
                textColor = 'text-white';
                icon = 'ü§ñ';
            } else {
                bgColor = 'bg-blue-100';
                textColor = 'text-blue-800';
                icon = '‚ö°';
            }

            messageDiv.innerHTML = `
                <div class="inline-block max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${bgColor} ${textColor}">
                    <div class="font-medium mb-1">${icon} ${sender === 'user' ? 'You' : sender === 'assistant' ? 'GHC Digital Twin' : 'System'}</div>
                    <div class="text-sm whitespace-pre-wrap">${content}</div>
                </div>
            `;

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            messages.push({ sender, content });
        }

        // Key press handler
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initVoiceRecognition();
            document.getElementById('messageInput').focus();
            
            setTimeout(() => {
                addMessage('system', languages[currentLang].welcomeMsg);
            }, 500);
        });
    </script>
</body>
</html>